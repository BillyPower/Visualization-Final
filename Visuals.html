<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>D3.js Bar Chart Example</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>

<script>
  // Load data from the GitHub repository
  d3.csv('https://raw.githubusercontent.com/BillyPower/Visualization-Final/main/Anime_list.csv').then(function(data) {
    // Convert 'members', 'score', and 'count_of_episodes' column values to numbers
    data.forEach(function(d) {
      d.members = +d.members;
      d.score = +d.score;
    });

    // Filter data for anime with score of 9 or higher
    const filteredData = data.filter(d => d.score >= 9);

    // Log the filtered data to inspect values
    console.log(filteredData);

    // Set up SVG container
    const svgWidth = 800;
    const svgHeight = 400;
    const barWidth = 30; // Width of each bar

    const svg = d3.select("body")
      .append("svg")
      .attr("width", svgWidth)
      .attr("height", svgHeight);

    // Create bars for score
    svg.selectAll(".score-bar")
      .data(filteredData)
      .enter()
      .append("rect")
      .attr("class", "score-bar")
      .attr("x", (d, i) => i * (barWidth + 5))
      .attr("y", d => svgHeight - d.score * 10)
      .attr("width", barWidth)
      .attr("height", d => d.score * 10)
      .attr("fill", "orange");

    // Create bars for members
    svg.selectAll(".members-bar")
      .data(filteredData)
      .enter()
      .append("rect")
      .attr("class", "members-bar")
      .attr("x", (d, i) => i * (barWidth + 5) + barWidth + 5)
      .attr("y", d => svgHeight - d.members * 0.1)
      .attr("width", barWidth)
      .attr("height", d => d.members * 0.1)
      .attr("fill", "steelblue");

    // Add labels
    svg.selectAll(".bar-label")
      .data(filteredData)
      .enter()
      .append("text")
      .attr("class", "bar-label")
      .text(d => d.Anime_name)
      .attr("x", (d, i) => i * (barWidth + 5) + barWidth / 2)
      .attr("y", d => svgHeight + 15)
      .attr("text-anchor", "middle")
      .attr("font-size", "10px")
      .attr("fill", "black");
  });
</script>

</body>
</html>
